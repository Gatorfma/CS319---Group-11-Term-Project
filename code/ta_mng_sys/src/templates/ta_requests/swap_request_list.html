{# code/ta_mng_sys/src/templates/ta_requests/swap_request_list.html #}
{% extends 'base.html' %}
{% block content %}
<div class="container mx-auto p-4">
  <h2 class="text-2xl font-bold mb-4">My Swap Requests</h2>

  {% if requests %}
    <table class="table-auto w-full mb-4">
      <thead>
        <tr>
          <th class="px-4 py-2">Your Duty</th>
          <th class="px-4 py-2">With</th>
          <th class="px-4 py-2">Reason</th>
          <th class="px-4 py-2">Status</th>
          <th class="px-4 py-2">Requested At</th>
        </tr>
      </thead>
      <tbody>
        {% for req in requests %}
        <tr class="border-t">
          <td class="px-4 py-2">{{ req.duty }}</td>
          <td class="px-4 py-2">{{ req.to_ta.user.get_full_name }}</td>
          <td class="px-4 py-2">{{ req.reason|truncatechars:30 }}</td>
          <td class="px-4 py-2">{{ req.get_status_display }}</td>
          <td class="px-4 py-2">{{ req.requested_at|date:"Y-m-d H:i" }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    {% if is_paginated %}
      <nav class="flex justify-center">
        <ul class="inline-flex">
          {% if page_obj.has_previous %}
            <li><a href="?page={{ page_obj.previous_page_number }}" class="px-3">« Prev</a></li>
          {% endif %}
          <li class="px-3">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</li>
          {% if page_obj.has_next %}
            <li><a href="?page={{ page_obj.next_page_number }}" class="px-3">Next »</a></li>
          {% endif %}
        </ul>
      </nav>
    {% endif %}

  {% else %}
    <p>You haven’t submitted any swap requests yet.</p>
  {% endif %}

  <a href="{% url 'ta_requests:swap-request' %}"
     class="mt-4 inline-block btn-indigo px-4 py-2 rounded">
    New Swap Request
  </a>
</div>
{% endblock %}
